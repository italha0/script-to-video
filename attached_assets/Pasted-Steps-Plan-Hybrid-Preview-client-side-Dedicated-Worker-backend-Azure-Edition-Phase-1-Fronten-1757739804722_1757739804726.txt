Steps Plan: Hybrid (Preview client-side + Dedicated Worker backend, Azure Edition)
Phase 1 â€” Frontend (Preview Mode)

Use Remotion Player in Next.js.

Add <Player> component for instant preview.

User edits messages / theme â†’ Player updates in real-time.

âœ… No backend load â†’ free preview.

Save composition JSON (user config: messages, avatars, colors, timestamps).

Send JSON in API request when user clicks Download.

Phase 2 â€” Backend API (Render Request)

Expose /api/render (Next.js API route or small Express server).

Input: compositionJson, resolution, preset.

Save job in Supabase DB â†’ status=pending.

Return: jobId.

Expose /api/render/:jobId/status

Response: { status: "pending|rendering|done|failed", url }.

Phase 3 â€” Worker (Azure VM)

Set up Azure VM (B2s: 2 vCPU, 4 GB RAM â†’ ~$20/mo, free if you have $200 Azure credits).

Install Docker + Node.js + Chromium deps.

Install Redis (for job queue).

Worker process:

Subscribes to Redis queue (bullmq).

On new job:

Run @remotion/renderer â†’ render video using JSON.

Upload video to Azure Blob Storage (instead of DO Spaces).

Update Supabase DB â†’ status=done, url=SignedURL.

Dockerize worker:

Create Dockerfile with Node, Remotion, Chromium.

Deploy container on VM with docker-compose.

Phase 4 â€” Storage (Azure Blob Storage)

Create an Azure Storage Account.

Make a videos container.

Worker uploads rendered video â†’ Blob Storage.

Generate SAS URL (signed URL, 1h expiry).

Return signed download URL to frontend.

Phase 5 â€” Frontend Download Flow

User clicks Download.

Call /api/render â†’ get jobId.

Show progress UI (Rendering videoâ€¦ â³).

Poll /api/render/:jobId/status.

Once status=done â†’ show Download Now button with Blob signed URL.

Phase 6 â€” Optimizations

Quota system â†’ Supabase row: daily_renders. Limit free tier to 5/day.

Watermark free users â†’ Add watermark layer in Remotion comp.

Compression â†’ Encode 720p, ~2 Mbps bitrate (small file size).

Auto-cleanup â†’ Delete blobs older than 7 days (Azure Lifecycle Policies).

Phase 7 â€” Monitoring

Log jobs in Supabase.

Use Azure Monitor â†’ track CPU, memory on VM.

Add Sentry for worker errors.

âš¡ Flow Recap (Azure Version)

User edits â†’ preview with Remotion Player (browser).

On download â†’ JSON sent to API â†’ saved in Supabase.

Worker on Azure VM renders â†’ uploads to Azure Blob.

Frontend polls â†’ shows signed SAS URL for download.

ğŸ”¥ Big Win: Azure Blob Storage + SAS tokens is cleaner and cheaper than DO Spaces, and Azure credits can cover both storage + VM.